<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心理学3D世界 - ブラウザ安全版</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: glow 2s infinite alternate;
        }
        
        @keyframes glow {
            from { filter: brightness(1); }
            to { filter: brightness(1.2); }
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .world-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .world-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .world-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        
        .world-card.active {
            background: rgba(76, 175, 80, 0.3);
            border-color: #4caf50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.4);
        }
        
        .world-icon {
            font-size: 4em;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .world-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #4ecdc4;
            text-align: center;
        }
        
        .world-description {
            font-size: 0.9em;
            line-height: 1.5;
            opacity: 0.8;
            text-align: center;
        }
        
        .details-section {
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            display: none;
        }
        
        .details-section.show {
            display: block;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .details-title {
            font-size: 2em;
            margin-bottom: 20px;
            color: #4ecdc4;
            text-align: center;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #4ecdc4;
        }
        
        .feature-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .feature-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #ffd700;
        }
        
        .feature-description {
            font-size: 0.85em;
            opacity: 0.8;
            line-height: 1.4;
        }
        
        .interaction-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }
        
        .action-button {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }
        
        .action-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 205, 196, 0.3);
        }
        
        .action-button.special {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%);
        }
        
        .demo-area {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .demo-content {
            font-size: 1.1em;
            line-height: 1.6;
        }
        
        .code-preview {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 0.8em;
            margin: 15px 0;
            border-left: 4px solid #4ecdc4;
            text-align: left;
            overflow-x: auto;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            border-left: 4px solid #4ecdc4;
        }
        
        .notification.show {
            opacity: 1;
        }
        
        .stats-panel {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #4ecdc4;
            display: block;
        }
        
        .stat-label {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: rgba(76, 175, 80, 0.6);
            border-radius: 50%;
            animation: float-particle 8s infinite linear;
        }
        
        @keyframes float-particle {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <div class="container">
        <div class="header">
            <h1>🧠 心理学3D世界</h1>
            <p class="subtitle">抽象的な概念を「見える」「触れる」ものに変える革新的学習システム</p>
        </div>
        
        <div class="world-grid">
            <div class="world-card" onclick="selectWorld('learning')">
                <div class="world-icon">🧠</div>
                <div class="world-title">記憶宮殿ワールド</div>
                <div class="world-description">
                    あなたの部屋を3D記憶空間に変換。学習効率を3倍向上させる古代ギリシャの記憶術を現代技術で実現。
                </div>
            </div>
            
            <div class="world-card" onclick="selectWorld('clinical')">
                <div class="world-icon">🏥</div>
                <div class="world-title">治療地形ワールド</div>
                <div class="world-description">
                    うつ病の谷、不安の山、PTSD の嵐を3D地形として表現。治療進捗が美しい地形変化として可視化。
                </div>
            </div>
            
            <div class="world-card" onclick="selectWorld('developmental')">
                <div class="world-icon">👶</div>
                <div class="world-title">時空間マップワールド</div>
                <div class="world-description">
                    胎児期から老年期まで、人生の発達軌道を4次元（3D+時間）で追跡。個人の成長が宇宙の軌道として表現。
                </div>
            </div>
            
            <div class="world-card" onclick="selectWorld('social')">
                <div class="world-icon">👥</div>
                <div class="world-title">集団力学ワールド</div>
                <div class="world-description">
                    人間関係を物理法則として表現。友情は引力、対立は斥力、リーダーシップは重力場として3D化。
                </div>
            </div>
            
            <div class="world-card" onclick="selectWorld('cognitive')">
                <div class="world-icon">⚡</div>
                <div class="world-title">思考フローワールド</div>
                <div class="world-description">
                    認知プロセスを光の川として可視化。情報処理、意思決定、認知バイアスが美しいフローチャートに。
                </div>
            </div>
        </div>
        
        <div class="details-section" id="detailsSection">
            <div class="details-title" id="detailsTitle">ワールドを選択してください</div>
            <div id="detailsContent">
                <!-- 動的にコンテンツが挿入される -->
            </div>
        </div>
        
        <div class="stats-panel">
            <div class="stat-item">
                <span class="stat-value" id="activeWorlds">5</span>
                <span class="stat-label">利用可能ワールド</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="learningEfficiency">340%</span>
                <span class="stat-label">学習効率向上</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="comprehension">95%</span>
                <span class="stat-label">理解度</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="engagement">MAX</span>
                <span class="stat-label">没入レベル</span>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // ワールドデータ
        const worlds = {
            learning: {
                title: '🧠 記憶宮殿ワールド',
                description: '学習効率を革命的に向上させる3D記憶空間システム',
                features: [
                    {
                        icon: '🏛️',
                        title: '個人用記憶宮殿',
                        description: 'あなたの実際の部屋や思い出の場所を3D化。各部屋に学習内容を配置し、空間記憶を活用'
                    },
                    {
                        icon: '📊',
                        title: 'リアルタイム効率測定',
                        description: '視線追跡、脳波、学習時間を分析。AIが最適な記憶ルートを提案'
                    },
                    {
                        icon: '🎮',
                        title: '学習ゲーミフィケーション',
                        description: '記憶クエスト、知識バトル、チーム宮殿建築で楽しく学習'
                    },
                    {
                        icon: '🔬',
                        title: '忘却曲線3D化',
                        description: 'エビングハウスの忘却曲線を地形として表現。復習タイミングが直感的に理解'
                    }
                ],
                code: `// 記憶宮殿の3D構築システム
const memoryPalace = new MemoryPalace3D();

// あなたの部屋をスキャンして3D化
const roomData = await scanUserRoom();
palace.buildFromRealSpace(roomData);

// 学習内容を空間に配置
palace.addMemoryRoom("心理学理論", {
    location: "リビング",
    items: ["フロイト", "ユング", "ピアジェ"],
    associations: createVisualAssociations()
});

// 学習効率をリアルタイム測定
const efficiency = palace.measureLearningEfficiency();
console.log('記憶定着率:', efficiency + '% 向上');`
            },
            clinical: {
                title: '🏥 治療地形ワールド',
                description: '心の状態を美しい3D地形として可視化する革新的治療支援システム',
                features: [
                    {
                        icon: '🌄',
                        title: 'うつ病地形システム',
                        description: 'うつ症状の深さを谷の深さで表現。治療により谷が浅くなり平原へ変化'
                    },
                    {
                        icon: '⛰️',
                        title: '不安山岳マップ',
                        description: '不安レベルを険しい山として可視化。治療により緩やかな丘へ変化'
                    },
                    {
                        icon: '🌊',
                        title: 'PTSD津波シミュレーション',
                        description: 'フラッシュバックを津波として表現。治療で波が穏やかになる過程を体験'
                    },
                    {
                        icon: '🏗️',
                        title: 'レジリエンス建築',
                        description: '心の回復力を建築物として構築。治療により強固な建物が建設'
                    }
                ],
                code: `// うつ病地形の動的生成システム
const depressionTerrain = new ClinicalTerrain3D();

// 症状スコアから地形を生成
const phq9Score = patient.getCurrentPHQ9();
terrain.generateDepression(phq9Score, {
    depth: phq9Score * 10,
    width: phq9Score * 5,
    color: 'hsl(' + (240 - phq9Score * 10) + ', 70%, 30%)'
});

// 治療進捗による地形変化
patient.onTreatmentProgress((progress) => {
    terrain.smoothTerrain(progress.improvementRate);
    if (progress.recoveryMilestone) {
        terrain.addHopeBeacon(progress.location);
    }
});`
            },
            developmental: {
                title: '👶 時空間マップワールド',
                description: '人間の生涯発達を4次元空間で追跡する革新的発達研究システム',
                features: [
                    {
                        icon: '⏰',
                        title: '4次元発達軌道',
                        description: '各個人の発達が美しい軌道として時空間に描かれ、発達パターンが一目で理解'
                    },
                    {
                        icon: '🧬',
                        title: '遺伝-環境相互作用',
                        description: '遺伝的要因と環境要因を異なる色の軌道で表現。相互作用が動的に変化'
                    },
                    {
                        icon: '🎯',
                        title: '発達段階境界面',
                        description: 'ピアジェ、エリクソンの発達段階を3D境界面として表現'
                    },
                    {
                        icon: '🔮',
                        title: '発達予測AI',
                        description: '機械学習により将来の発達軌道を予測。リスク要因も可視化'
                    }
                ],
                code: `// 4次元発達空間の構築
const developmentalSpace = new FourDimensionalSpace();

// 時間軸設定（0-100歳）
space.setTimeAxis(0, 100, "years");

// 発達領域の3軸設定
space.setDevelopmentalAxes({
    cognitive: { axis: "x", color: "blue" },
    social: { axis: "y", color: "green" },
    emotional: { axis: "z", color: "red" }
});

// 個人の発達軌道をプロット
const trajectory = new DevelopmentalTrajectory();
lifeEvents.forEach((event, age) => {
    trajectory.addPoint({
        age: age,
        cognitive: assessCognitive(event),
        social: assessSocial(event),
        emotional: assessEmotional(event)
    });
});

space.plotTrajectory(trajectory);`
            },
            social: {
                title: '👥 集団力学ワールド',
                description: '人間関係と集団行動を物理シミュレーションとして3D化',
                features: [
                    {
                        icon: '🌐',
                        title: '社会ネットワーク物理学',
                        description: '人間関係を重力、電磁気力として表現。友情は引力、対立は斥力'
                    },
                    {
                        icon: '👑',
                        title: 'リーダーシップ場理論',
                        description: 'リーダーの影響力を磁場として可視化。フォロワー行動が磁力線で表現'
                    },
                    {
                        icon: '🌊',
                        title: '同調圧力の波動',
                        description: '集団内同調現象を波動として表現。意見変化が波の伝播として移動'
                    },
                    {
                        icon: '⚡',
                        title: '偏見の電気回路',
                        description: 'ステレオタイプを電気回路として表現。回路変更で偏見を減少'
                    }
                ],
                code: `// 社会集団の物理シミュレーション
const socialPhysics = new SocialPhysicsEngine();

// 個人をパーティクルとして定義
const groupMembers = [
    new SocialParticle("Leader", { influence: 100 }),
    new SocialParticle("Follower1", { conformity: 80 }),
    new SocialParticle("Rebel", { conformity: 20 })
];

// 社会力の定義
socialPhysics.addForce("friendship", (p1, p2) => {
    return attractiveForce(p1.compatibility(p2));
});

socialPhysics.addForce("status_hierarchy", (leader, follower) => {
    return gravitationalForce(leader.status, follower.position);
});

// シミュレーション実行
socialPhysics.simulate(groupMembers, {
    duration: "6_months",
    events: ["conflict", "cooperation", "leadership_change"]
});`
            },
            cognitive: {
                title: '⚡ 思考フローワールド',
                description: '思考プロセスを美しいフローチャートとして3D化',
                features: [
                    {
                        icon: '🌊',
                        title: '情報処理の川',
                        description: '感覚入力から記憶保存まで、情報処理の流れを光る川として表現'
                    },
                    {
                        icon: '🧩',
                        title: '認知バイアスの歪み',
                        description: '確証バイアス等が思考の川を歪める障害物として可視化'
                    },
                    {
                        icon: '🧠',
                        title: 'ニューラルネット3D',
                        description: 'AIと人間の認知を並行表示。類似点・相違点を直感的に比較'
                    },
                    {
                        icon: '🏗️',
                        title: 'メタ認知タワー',
                        description: '「考えることについて考える」を高層タワーで表現。俯瞰で思考を客観視'
                    }
                ],
                code: `// 認知プロセスの3Dフロー
const cognitiveFlow = new CognitiveProcess3D();

// 情報処理パイプライン構築
const pipeline = cognitiveFlow.createPipeline([
    new SensoryInput({ modalities: ["visual", "auditory"] }),
    new AttentionFilter({ selectivity: 0.1 }),
    new WorkingMemory({ capacity: 7, duration: 30 }),
    new LongTermMemory({ encoding: "semantic" })
]);

// 認知バイアスの干渉
const biases = [
    new ConfirmationBias({ strength: 0.7 }),
    new AvailabilityHeuristic({ recency_weight: 0.8 })
];

biases.forEach(bias => pipeline.addInterference(bias));

// リアルタイム思考可視化
const session = cognitiveFlow.startSession();
session.onThought((thought) => {
    render3DThought({
        concept: thought.content,
        associations: thought.getAssociations(),
        confidence: thought.certaintyLevel
    });
});`
            }
        };
        
        let currentWorld = null;
        let demoRunning = false;
        
        // 初期化
        function init() {
            createParticles();
            showNotification('🌌 心理学3D世界へようこそ！ワールドを選択してください。');
        }
        
        // パーティクル生成
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (6 + Math.random() * 4) + 's';
                container.appendChild(particle);
            }
        }
        
        // ワールド選択
        function selectWorld(worldType) {
            currentWorld = worldType;
            const world = worlds[worldType];
            
            // カードのアクティブ状態更新
            document.querySelectorAll('.world-card').forEach(card => {
                card.classList.remove('active');
            });
            event.target.closest('.world-card').classList.add('active');
            
            // 詳細セクション表示
            const detailsSection = document.getElementById('detailsSection');
            const detailsTitle = document.getElementById('detailsTitle');
            const detailsContent = document.getElementById('detailsContent');
            
            detailsTitle.textContent = world.title;
            
            detailsContent.innerHTML = `
                <p style="font-size: 1.1em; margin-bottom: 25px; text-align: center; opacity: 0.9;">
                    ${world.description}
                </p>
                
                <div class="features-grid">
                    ${world.features.map(feature => `
                        <div class="feature-item">
                            <div class="feature-icon">${feature.icon}</div>
                            <div class="feature-title">${feature.title}</div>
                            <div class="feature-description">${feature.description}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="interaction-panel">
                    <button class="action-button" onclick="startDemo('${worldType}')">
                        🎮 デモ体験
                    </button>
                    <button class="action-button" onclick="showCode('${worldType}')">
                        💻 コード表示
                    </button>
                    <button class="action-button" onclick="explainConcept('${worldType}')">
                        🤖 Claude解説
                    </button>
                    <button class="action-button special" onclick="createPersonalized('${worldType}')">
                        ✨ カスタマイズ
                    </button>
                </div>
                
                <div class="demo-area" id="demoArea-${worldType}">
                    <div class="demo-content">
                        ${world.title}の機能を体験するには上のボタンをクリックしてください
                    </div>
                </div>
            `;
            
            detailsSection.classList.add('show');
            showNotification(`${world.title}を選択しました！`);
            
            // 統計更新
            updateStats();
        }
        
        // デモ開始
        function startDemo(worldType) {
            const world = worlds[worldType];
            const demoArea = document.getElementById(`demoArea-${worldType}`);
            
            demoArea.innerHTML = `
                <div class="demo-content">
                    <h3 style="color: #4ecdc4; margin-bottom: 15px;">🎮 ${world.title} デモ実行中...</h3>
                    <p>3D環境を構築し、インタラクティブ要素を初期化しています。</p>
                    <div style="margin: 20px 0; font-size: 2em;">
                        ${worldType === 'learning' ? '🏛️ 記憶宮殿建築中...' :
                          worldType === 'clinical' ? '🌄 治療地形生成中...' :
                          worldType === 'developmental' ? '⏰ 時空間マップ展開中...' :
                          worldType === 'social' ? '🌐 社会ネットワーク構築中...' :
                          '⚡ 思考フロー可視化中...'}
                    